Drop python 3.7 support and migrate from flake8 to ruff/black.
